# =============================================================================
# AWS Production Environment Configuration - EC2 with RDS PostgreSQL
# =============================================================================
# This configuration is for AWS EC2 deployment with Amazon RDS PostgreSQL
# Use this for production deployments requiring managed database service
#
# To use this configuration:
#   1. Create RDS PostgreSQL instance in AWS Console
#   2. Deploy application to EC2 instance
#   3. Copy this file: cp aws-env.rds.example aws-env
#   4. Update RDS endpoint and credentials
#   5. Update API keys and domain name
#   6. Run: sudo ./remote-scripts/setup-application.sh
#
# For EC2 with local PostgreSQL, see: aws-env.ec2.example
# =============================================================================

# Environment
ENVIRONMENT=production

# Deployment Path (where the application is deployed)
ENVIRONMENT_PATH=/opt/crypto-ia

# Database (Amazon RDS PostgreSQL)
# Update with your RDS instance endpoint and credentials
DATABASE_URL=postgresql://crypto_user:YOUR_RDS_PASSWORD@your-rds-instance.region.rds.amazonaws.com:5432/crypto_db
DB_POOL_SIZE=20  # Higher for RDS
DB_MAX_OVERFLOW=40

# Web UI
WEB_UI_HOST=crypto-ai.crypto-vision.com  # CHANGE TO YOUR DOMAIN
WEB_UI_PORT=443
WEB_UI_PROTOCOL=https

# SSL Certificate
# Self-signed certificates are auto-generated by setup script
# For production, replace with Let's Encrypt or your own certificates
SSL_CERT_PATH=/opt/crypto-ia/certs/server.crt
SSL_KEY_PATH=/opt/crypto-ia/certs/server.key

# Data Collection
COLLECTION_START_DATE=2024-01-01
TOP_N_CRYPTOS=50
COLLECTION_SCHEDULE=0 */6 * * *  # Every 6 hours
BINANCE_API_KEY=your_binance_key_here  # REQUIRED
BINANCE_API_SECRET=your_binance_secret_here  # REQUIRED

# Prediction Engine
MODEL_TYPE=LSTM  # or GRU
PREDICTION_HORIZON_HOURS=24
MODEL_RETRAIN_SCHEDULE=0 2 * * 0  # Weekly on Sunday at 2 AM
SEQUENCE_LENGTH=168  # 7 days of hourly data

# GenAI (REQUIRED)
OPENAI_API_KEY=your_openai_key_here  # Get from https://platform.openai.com/api-keys
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=500
OPENAI_TEMPERATURE=0.7

# Alert System
ALERT_ENABLED=true
ALERT_THRESHOLD_PERCENT=10.0
ALERT_COOLDOWN_HOURS=4
SMS_PROVIDER=aws_sns  # Recommended for AWS deployments
SMS_PHONE_NUMBER=+1234567890  # Your phone number for alerts

# AWS SNS Configuration
AWS_SNS_TOPIC_ARN=arn:aws:sns:us-east-1:123456789012:crypto-alerts  # CHANGE THIS
AWS_REGION=us-east-1

# API
API_HOST=0.0.0.0
API_PORT=5000
API_KEY_REQUIRED=true  # Enable API key authentication in production
RATE_LIMIT_PER_MINUTE=100

# Streamlit
STREAMLIT_PORT=8501

# Security
SECRET_KEY=CHANGE_ME_TO_RANDOM_SECRET_KEY  # Generate with: openssl rand -hex 32
ALLOWED_ORIGINS=https://crypto-ai.crypto-vision.com  # CHANGE TO YOUR DOMAIN

# Logging
LOG_LEVEL=INFO
LOG_FILE=/var/log/crypto-saas/app.log

# Log Retention
AUDIT_LOGS_RETENTION_DAYS=90
CHAT_HISTORY_RETENTION_DAYS=30
QUERY_AUDIT_LOGS_RETENTION_DAYS=365
SYSTEM_LOGS_RETENTION_DAYS=30
LOG_RETENTION_SCHEDULE=0 2 * * *  # Daily at 2 AM

# =============================================================================
# RDS SETUP INSTRUCTIONS
# =============================================================================
#
# 1. Create RDS PostgreSQL Instance:
#    - Engine: PostgreSQL 15
#    - Instance Class: db.t3.micro (free tier) or db.t3.small
#    - Storage: 20GB GP3 with autoscaling
#    - Multi-AZ: Enable for production
#    - VPC: Same VPC as your EC2 instance
#    - Security Group: Allow PostgreSQL (5432) from EC2 security group
#    - Database Name: crypto_db
#    - Master Username: crypto_user
#    - Master Password: Generate strong password
#    - Backup Retention: 7 days minimum
#    - Enable automated backups
#    - Enable encryption at rest
#
# 2. Configure Security Group:
#    - RDS Security Group: Allow inbound 5432 from EC2 security group
#    - EC2 Security Group: Allow outbound 5432 to RDS security group
#
# 3. Get RDS Endpoint:
#    - Go to RDS Console → Databases → Your Instance
#    - Copy the Endpoint (e.g., mydb.abc123.us-east-1.rds.amazonaws.com)
#
# 4. Update DATABASE_URL:
#    DATABASE_URL=postgresql://crypto_user:YOUR_PASSWORD@YOUR_ENDPOINT:5432/crypto_db
#
# 5. Deploy Application:
#    - Launch EC2 instance in same VPC
#    - Clone repository to /opt/crypto-ia
#    - Copy this file to aws-env
#    - Update all credentials and settings
#    - Run setup scripts (skip setup-postgresql.sh)
#
# 6. Initialize Database:
#    cd /opt/crypto-ia
#    source venv/bin/activate
#    alembic upgrade head
#
# 7. Start Services:
#    sudo ./remote-scripts/start-services.sh
#
# =============================================================================
# RDS BENEFITS
# =============================================================================
# ✓ Automated backups and point-in-time recovery
# ✓ Automatic software patching
# ✓ Multi-AZ deployment for high availability
# ✓ Read replicas for scaling
# ✓ Monitoring with CloudWatch
# ✓ Encryption at rest and in transit
# ✓ No database maintenance required
#
# RDS COSTS (Approximate):
# - db.t3.micro: ~$15/month (free tier eligible)
# - db.t3.small: ~$30/month
# - Storage: ~$0.115/GB/month
# - Backup storage: First 20GB free
#
# =============================================================================
# SECURITY CHECKLIST
# =============================================================================
# [ ] Update SECRET_KEY with random value
# [ ] Update WEB_UI_HOST with your domain
# [ ] Update ALLOWED_ORIGINS with your domain
# [ ] Add your OPENAI_API_KEY
# [ ] Add your BINANCE_API_KEY and SECRET (if collecting data)
# [ ] Configure AWS SNS topic for alerts
# [ ] Update RDS endpoint and credentials in DATABASE_URL
# [ ] Enable RDS encryption at rest
# [ ] Enable RDS automated backups (7+ days retention)
# [ ] Configure RDS security group (allow only from EC2)
# [ ] Enable Multi-AZ for production
# [ ] Configure SSL certificates (Let's Encrypt recommended)
# [ ] Enable API_KEY_REQUIRED and create API keys
# [ ] Configure EC2 Security Group to restrict access
# [ ] Set up CloudWatch monitoring and alarms
# [ ] Enable RDS Performance Insights
# [ ] Configure VPC flow logs
#
# =============================================================================
